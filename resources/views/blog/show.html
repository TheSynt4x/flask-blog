{% extends 'layouts/app.html' %}
{% block description %}Post {{ post.id }}{% endblock %}

{% from 'macros/pagination-macro.html' import render_pagination %}

{% block content %}
    <div class="row">
        <div class="col-lg-8">
            <h1 class="mt-4">{{ post.title }}</h1>
            <p class="lead">
                by
                <a href="#">{{ post.user.username }}</a>
            </p>


            <p>Posted {{ post.posted_at|humanize }}</p>

            <hr>

            <p>{{ post.content }}</p>

            <hr>

            {% if not session.get('user_id') %}
                <h3 class="my-4 mb-5">
                    You must be <a href="{{ url_for('login') }}">signed in</a> to leave a comment.
                </h3>
            {% else %}
                <div class="card my-4">
                    <h5 class="card-header">Leave a Comment:</h5>
                    <div class="card-body">
                        <form action="{{ url_for('blog.post.comment', post_id=post.id) }}" method="POST">
                            <div class="form-group">
                                <textarea name="comment" class="form-control" rows="3"></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Submit</button>
                        </form>
                    </div>
                </div>
            {% endif %}

            {% for comment in comments.items %}
                <div class="media mb-4">
                    <img class="d-flex mr-3 rounded-circle" width="100" height="100" src="{{ base_url }}/images/{{ comment.user.avatar }}" alt="">
                    <div class="media-body">
                        <h5 class="mt-0">{{ comment.user.username }} <small
                                class="small">{{ comment.posted_at|humanize }}</small></h5>
                        {{ comment.comment }}
                    </div>
                </div>
            {% endfor %}

            {{ render_pagination(comments, simple=False) }}
        </div>

        {% include 'partials/sidebar.html' %}
    </div>
{% endblock %}